### Нейронная сеть PriceNet 

Система представляет собой глубокую трехслойную модель, предназначенную для **одновременного** прогнозирования **оптимальной цены** для заказа, и вероятности согласия пассажира на эту стоимость. Это позволяет без проблем и длительных раздумий максимизировать выгоду водителя от выполнения заказа и при этом не терять клиентов при выставлении слишком большой стоимости. 

**Ключевые особенности** - использование Multi - Task Learning с адаптивным взвешиванием потерь. 

#### Архитектура 

Нейронная сеть использует одно общее тело и две головы (Price Head, Prob Head).
	- Общее тело извлекает признаки из входных данных (Параметры входа)
	- Price Head предсказывает цену на предстоящую поездку
	- Prob Head предсказывает вероятность, с которой пассажир согласится на эту цену

Адаптивное взвешивание функции потерь позволяет нейронной сети самостоятельно находить баланс между оптимальными значениями цены и вероятности. 

Дополнительно на вход PriceNet данные подают две другие ML модели: linear_reg_price_learn и time_model_leaern, они передают данные о примерной цене с коэффициентом (на сколько повышена или понижена цена), и данные о примерном времени прибытия транспортного средства. 
##### Дополнительная информация
- Для предотвращения затухания градиента используется ResNet (class ResidualBlock)

#### Запуск 
1. Запустите файл linear_reg_price_learn.py, что бы сформировался файл base_model.pkl.
	``` terminal
	python linear_reg_price_learn.py
	```
2. Запустите файл time_model_leaern.py, для того что бы сформировался файл waiting_time_model.pkl
	``` terminal
	python time_model_leaern.py
	```
3. Запустите файл pricenet_model_learn.py сформируются веса для работы инференса.
	``` terminal
	python pricenet_model_learn.py
	```
4. Запустите pricenet_v3.py нужными параметрами.
	``` terminal
	python pricenet_v3.py
	```
Параметры:
``` python
test_order = {

        "order_timestamp": "2025-01-13 13:15:00",

        "price_start_local": 150,

        "distance_in_meters": 4000,

        "duration_in_seconds": 3600,

        "pickup_in_meters": 800,

        "pickup_in_seconds": 120,

        "driver_rating": 4.7,

        "user_rating": 4.95,

    }

```

#### Зависимости

1. PyTorch, torch.nn
2. Pundas
3. NumPy
4. Scikit-learn
5. xgboost
6. joblib